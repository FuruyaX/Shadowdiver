# Shadowdiver
Action and rougelike game

ゲーム設計仕様書: Shadow Diver: Abyssal Echoes
ゲームコンセプト
プレイヤーは深層を目指す「ダイバー」となり、ランダム生成されるダンジョンを探索するアクション & ターン制ローグライクゲーム。
視界の限られた暗闇の中、姿を見せない敵「シャドウ」の気配を察知し、多彩なアイテムを駆使して危機を乗り越え、より深い階層へと進むことが目的。

2. ゲームフロー: ゲームの開始から終了までの基本的な流れ。
ゲーム開始: プレイヤーは地下1階からスタート。初期アイテムを所持。

フロア探索:
プレイヤーはメイン画面とマップを頼りにリアルタイムに探索行動（移動/アイテム使用/待機など）を行う。
時間はリアルタイムで経過し、メッセージ表示時やメニュー表示時等一部の状態を除いて常に進み続ける
スタミナは一部の行動に消費し、時間経過と共にスタミナが回復する。

入力はキーボード、画面にフローティング表示されたコントローラ、もしくは機器に有線/無線接続されたコントローラで行う
移動やアイテム使用のキーやボタンは開始前・ゲーム中にコンフィグで変更可能

イベント/エンカウント:
探索中、アイテムや宝箱を発見したり、罠を踏んだりする。
敵「シャドウ」に捕捉されるとエンカウントモードに移行。

フロア移動:
フロア内の「階段」に到達すると、次のフロアへ移動。
新しいフロアは再び自動生成される。

ゲームオーバー:
プレイヤーのHPが0になると探索失敗となり、ゲームオーバー。

3. プレイヤーレイヤー 👤
プレイヤーキャラクターに関する仕様です。

コアステータス:

HP (Health Points): 体力。0になるとゲームオーバー。罠や敵の攻撃で減少。
ST (Stamina): 行動力。移動や特定のスキルで消費。ターン経過で少量ずつ自然回復。

基本アクション:(コストはスタミナの消費量)
・移動 (上下左右): 1マス移動する。
・インタラクト (待機/発見): その場にあるエンティティ（階段、アイテム等）に干渉する。コスト: ST 1。
アイテム使用: インベントリからアイテムを選択して使用する。コスト: アイテムによる。

インベントリ:
容量: 最大10個までアイテムを所持可能。
カテゴリ: アイテムは「戦闘」「移動」「探索」「特殊」の4つに大別される。

4. ダンジョンレイヤー 🗺️
ゲームの舞台となる環境の仕様です。

マップ仕様:
サイズ: 200x200のグリッド。
自動生成: 
アルゴリズムにより、フロア移動のたびに通路や部屋の構造がランダムに生成される。
自動生成は、ランダムにコアとなるアルゴリズムを選択した上で、更にランダム性を持たせたアルゴリズムを付加したアルゴリズムを開始時に生成し、それを元にランダム生成する
現在は「ドランカード・ウォーク」アルゴリズム」をコアに採用

視界システム (Fog of War):
マップにはプレイヤーの周囲5マスの範囲のみが明るく表示される（視認エリア）。
一度通過した場所は薄暗く表示され、構造のみ確認できる（発見済みエリア）。
未探索の場所は完全な闇で覆われる。
探索済みの箇所は壁や罠、宝箱等が正しく表示される

メイン画面:
メイン画面では現在位置から現在の向いている方向に見える壁や宝箱、罠などが見える
このメイン画面を見ているだけでもゲームの進行が可能であり、ゲームを把握することが可能である。
視界はマップ上のフォグの範囲までとなる。
敵(シャドウ)が一定距離まで近づくとメイン画面全体が薄暗くなる

メッセージ画面:
敵の動向(表示される場合のみ)、アイテムの取得、ダメージ表記等、システムメッセージが表示される領域

選択肢表示画面：
選択肢が出る場合はここに表示

エンティティ (配置物):
階段: 次のフロアへ進むための出口。
アイテム: 床に落ちており、拾うことができる。
宝箱: 鍵や特定のアイテムで開けることができる。中には貴重なアイテムが眠る。（※現実装では配置の基礎のみ）
罠: 踏むとHPダメージを受ける。一度可視化されると視認可能。

5. 敵AIレイヤー 
敵キャラクター「シャドウ」の仕様です。本作のコアとなる最も複雑なレイヤーです。

基本コンセプト:
マップ上では姿が見ず、メイン画面でのみ知覚可能の存在。
プレイヤーとの距離や自身の状態に応じて、4つのモードを遷移するステートマシンAIを搭載。
プレイヤーはメッセージに表示される「気配」から、敵のモードと位置を推測して行動する必要がある。

https://docs.google.com/spreadsheets/d/1dqzVxlfXCLJSd8F8cKQOK6WB5VdO1rlZACUYA3-gdS8/edit?usp=sharing

graph TD
    A[索敵モード] -- プレイヤー接近 --> B(アクティブモード);
    A -- 時間経過 --> D(徘徊モードB);
    B -- 短時間経過 --> C(徘徊モードA);
    C -- 短時間経過 --> D;
    D -- プレイヤー接近 --> B;
    D -- 時間経過(ランダム) --> A;


エンカウントシステム:

プレイヤーとシャドウが同一マスに侵入すると発生。
即時ゲームオーバーではなく、コマンド選択式の危機回避モードに移行。
選択肢:
回避: 大量のSTを消費し、50%の確率で追跡を振り切る。失敗すると大ダメージ。
アイテム使用: 「スモーク弾」や「閃光弾」など、インベントリ内の戦闘カテゴリのアイテムを使用して状況を打開する。

https://docs.google.com/spreadsheets/d/16pNCtnmxE9xLQ64S5XrPC3T3hsF-JnHONsFMh-C1_bA/edit?usp=sharing

7. UI/UXレイヤー 🖥️
プレイヤーへの情報伝達と操作に関する仕様です。

画面構成:
マップ表示: 視界システムに基づき描画。
メイン画面: ゲームの中心。視界システムに基づき描画。
ステータスパネル: フロア、HP、STを常時表示。
メッセージ画面: 敵の気配、行動結果、システムメッセージなどを表示。
メッセージログ: メッセージ画面に表示された内容を時系列で表示。ログの種別（危険、警告、情報）で色分けされる。
インベントリパネル: 所持アイテムを一覧表示。クリックで詳細確認や使用が可能。

入力:
キーボード:
矢印キー/WASD: 移動
Enter/スペースキー: アイテム取得、決定キー、探索キー

フローティングコントローラ:
十字キー: 移動
〇(任意)キー: アイテム取得、決定キー、探索キー

フローティングコントローラ:
十字キー: 移動
〇(任意)キー: アイテム取得、決定キー、探索キー

オーバーレイ:
エンカウント時やゲームオーバー時に画面全体を覆うように表示され、専用の選択肢やメッセージを提示する。
